
<!-- README.md is generated from README.Rmd. Please edit that file -->

# NegBinomHMC

<!-- badges: start -->
<!-- badges: end -->

NegBinomHMC is an R package that implements Hamiltonian Monte Carlo
(HMC) sampling for Bayesian Negative Binomial regression models. The
package provides functions to simulate Negative Binomial data, calculate
log-posterior densities and gradients, and perform adaptive HMC sampling
with a warmup phase to tune the step size automatically.

## Overview

Negative Binomial regression is commonly used for modeling
over-dispersed count data. With NegBinomHMC, you can: - **Simulate
Data:** Generate synthetic datasets following a Negative Binomial
distribution using a specified regression model. - **Model Evaluation:**
Calculate the log-posterior and its gradient for your Negative Binomial
regression model. - **Adaptive HMC Sampling:** Sample from the Bayesian
posterior using an adaptive HMC sampler that tunes its step size during
a warmup period to achieve a desired acceptance rate.

This package is intended for educational purposes and as a starting
point for more advanced Bayesian inference in count data models.

## Package Structure

``` bash
NegBinomHMC/
├── DESCRIPTION       # Package metadata
├── NAMESPACE         # Exports information generated by roxygen2
├── R/
│   ├── simulate_negbin_data.R       # Data simulation function
│   ├── log_posterior_negbin.R       # Log-posterior function
│   ├── grad_log_posterior_negbin.R  # Gradient function for the log-posterior
│   ├── hmc_sampler.R                # Adaptive HMC sampler and helper functions
├── man/              # Documentation files (generated via roxygen2)
├── README.md         # This file
└── LICENSE           # License file
```

## Installation

You can install the development version of NegBinomHMC from
[GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("Kumachar/NegBinomHMC")
```

## Example

Below is a basic example demonstrating how to simulate Negative
Binomials data and run the adaptive HMC sampler to estimate the
regression coefficients.

``` r
library(NegBinomHMC)

# Set simulation parameters
n <- 200              # Number of observations
p <- 3                # Number of predictors (including intercept)
beta_true <- c(1, 0, -1)  # True regression coefficients
r <- 2                # Dispersion parameter

# Simulate Negative Binomial data
data <- simulate_negbin_data(n, p, beta_true, r, seed = 123)
X <- data$X
y <- data$y

# Run the adaptive HMC sampler
result <- hmc_sampler(
  log_post = log_posterior_negbin,
  grad_log_post = grad_log_posterior_negbin,
  initial_beta = rep(0, p),
  initial_epsilon = 0.01,
  L = 10,
  n_iter = 1000,
  n_warmup = 500,
  X = X,
  y = y,
  r = r,
  beta_mu = 0,
  beta_sigma = 1,
  target_accept = 0.6
)

cat("True beta:", beta_true, "\n")
#> True beta: 1 0 -1
cat("Estimated beta (mean):", colMeans(result$samples), "\n")
#> Estimated beta (mean): 0.9857302 -0.101327 -0.9700795
cat("Acceptance rate:", result$acceptance_rate, "\n")
#> Acceptance rate: 0.7466667
cat("Final epsilon:", result$final_epsilon, "\n")
#> Final epsilon: 0.08763474
```

## Contributing

Contributions to NegBinomHMC are welcome. If you encounter issues or
have suggestions for improvements, please feel free to open an issue or
submit a pull request on the GitHub repository.

## License

This project is licensed under the MIT License. See the LICENSE file for
details.

## Contact

For questions or further information, please contact Weixiong at
\[<wxhua@umich.edu>\].
